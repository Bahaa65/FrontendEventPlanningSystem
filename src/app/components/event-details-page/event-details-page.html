<div class="event-details-container">

  <!-- Loading State -->
  <div *ngIf="isLoading && !event" class="loading-container">
    <p>Loading event...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="errorMessage && !isLoading" class="error-container">
    <p class="error-message">{{ errorMessage }}</p>
    <button class="btn-secondary" (click)="loadEvent()">Try Again</button>
  </div>

  <!-- Event Content (always renders when event exists) -->
  <div *ngIf="event && !isLoading" class="event-content">
    <!-- Event Header -->
    <app-event-header-card
      [event]="event"
      [isOrganizer]="isOrganizer"
      (deleteEvent)="onDeleteEvent()">
    </app-event-header-card>

    <!-- Event Description -->
    <app-event-description-box
      [description]="event.description">
    </app-event-description-box>

    <!-- RSVP Section (Attendee Only) -->
    <app-event-rsvp-section
      *ngIf="!isOrganizer"
      [eventId]="eventId"
      [currentStatus]="event.attendanceStatus"
      (statusChanged)="onRsvpChanged()">
    </app-event-rsvp-section>

    <!-- Invitee Table (Organizer Only) -->
    <app-event-invitee-table
      *ngIf="isOrganizer"
      [eventId]="eventId"
      [invitees]="event.invitees || []"
      (inviteeChanged)="refreshEvent()">
    </app-event-invitee-table>

    <!-- Attendance Summary (Attendee Only) -->
    <div *ngIf="!isOrganizer" class="attendance-summary">
      <h3>Event Summary</h3>
      <div class="summary-stats">
        <div class="stat-item going">
          <span class="icon">✔</span>
          <span class="count">{{ goingCount }}</span>
          <span class="label">Going</span>
        </div>
        <div class="stat-item maybe">
          <span class="icon">➖</span>
          <span class="count">{{ maybeCount }}</span>
          <span class="label">Maybe</span>
        </div>
        <div class="stat-item not-going">
          <span class="icon">✖</span>
          <span class="count">{{ notGoingCount }}</span>
          <span class="label">Not Going</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Delete Confirmation Modal -->
  <div *ngIf="showDeleteModal" class="modal-overlay" (click)="cancelDelete()">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <h2>Delete Event</h2>
      <p>Are you sure you want to delete this event? This action cannot be undone.</p>
      <div class="modal-actions">
        <button class="btn-secondary" (click)="cancelDelete()">Cancel</button>
        <button class="btn-danger" (click)="confirmDelete()">Delete</button>
      </div>
    </div>
  </div>
</div>